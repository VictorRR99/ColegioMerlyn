--Facilitador SELECT
SELECT * FROM Pessoa;
SELECT * FROM Sala;
SELECT * FROM Aluno;
SELECT * FROM Notas;
SELECT * FROM Disciplina;
SELECT * FROM Sala_Disc;
SELECT * FROM Professor;
SELECT * FROM Diretor;
--END-- Facilitador DROP TABLE

--Facilitador DROP TABLE
DROP TABLE Pessoa;
DROP TABLE Sala;
DROP TABLE Aluno;
DROP TABLE Notas;
DROP TABLE Disciplina;
DROP TABLE Sala_Disc;
DROP TABLE Professor;
DROP TABLE Diretor;
--END-- Facilitador DROP TABLE

-- PESQUISAS NO SISTEMA

-- ALUNOS COM MAIS DE 15 ANOS
SELECT nome FROM Pessoa INNER JOIN Aluno ON cd_pessoa = cd_aluno 
AND DATE_PART('year', NOW()) - DATE_PART('year', dt_nasc) > 15;

-- NOME DE TODOS OS ALUNOS COM SUAS NOTAS
SELECT cd_aluno FROM Alunos UNION SELECT cd_aluno FROM Notas;

-- NOME DOS ALUNOS QUE NÃO POSSUEM NOTAS
SELECT nome FROM Aluno LEFT JOIN Notas ON NP1 = NULL OR NP2 = NULL;

-- NOME DOS ALUNOS QUE ESTÃO ACIMA DA MÉDIA POR BIMESTRE
SELECT nome FROM Aluno WHERE cd_aluno = (SELECT cd_aluno FROM Notas WHERE (NP1 + NP2)/2 >= 7);
